<h1>Editar evento</h1>

<%= form_for @sale_event,
    url:update_sale_event_path, method: :put,
    id: "sale_event_form",
    :html => {class: 'new_sale_event row'} do |f|%>
  <%= f.hidden_field :id, value: @sale_event.id %>
  <div class="col-md-6 col-sm-12 form-group clase_x">
    <%= f.label(:title, "Nombre del evento") %>
    <%= f.text_field :title, value: @sale_event.title, required: true %>
  </div>
  <div class="col-md-6 col-sm-12 form-group clase_x">
    <%= f.label(:place, "Lugar") %>
    <%= f.text_field :place, value: @sale_event.place, required: true %>
  </div>
  <div class="col-md-6 col-sm-12 form-group clase_x">
    <%= f.label(:description, "DescripciÃ³n") %>
    <%= f.text_field :description, value: @sale_event.description, required: true %>
  </div>
  <div class="col-md-6 col-sm-12 form-group clase_x">
    <%= f.label(:event_date, "Fecha") %>
    <%= f.datetime_field :event_date, value: @sale_event.event_date.strftime("%Y-%m-%dT%H:%M"), required: true %>
  </div>
  <div class="col-md-6 col-sm-12 form-group clase_x upload carthumb photoshoot__upload">
    <%= f.label(:image, "Imagen") %>
    <%= f.file_field :image %>
    <%if !@sale_event.image.present?%>
      <img class="img-thumbnail center-block" alt="your image" target="_blank" src="" style="display: none;">
    <%else%>
      <img class="img-thumbnail center-block" alt="your image" target="_blank" src="<%=@sale_event.image.url%>">
    <%end%>
  </div>
  <%= submit_tag("Finalizar") %>
<% end %>

<script type="text/javascript">
  function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function (e) {
            // Remove class upload, the one that has the background image
            var $parent = $(input).closest('div.carthumb');
            $($parent).removeClass("upload");
            // Show the img tag
            $($parent).find('img').show();

            // Change the src of the img tag to the img loaded
            $($parent).find('img').attr('src', reader.result);
        }

        reader.readAsDataURL(input.files[0]);
    }
  }

  // Everytime the [input:file] change do
  $(":file").change(function(){
      readURL(this);
  });
</script>
